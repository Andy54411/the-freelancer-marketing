{
  "variables": [
    {
      "name": "DSGVO - Analytics Consent Status",
      "type": "jsm",
      "parameter": [
        {
          "type": "TEMPLATE",
          "key": "javascript",
          "value": "function() {\n  var consent = localStorage.getItem('taskilo-cookie-consent');\n  if (consent) {\n    var consentData = JSON.parse(consent);\n    return consentData.analytics ? 'granted' : 'denied';\n  }\n  return 'denied';\n}"
        }
      ]
    },
    {
      "name": "DSGVO - Marketing Consent Status",
      "type": "jsm",
      "parameter": [
        {
          "type": "TEMPLATE",
          "key": "javascript",
          "value": "function() {\n  var consent = localStorage.getItem('taskilo-cookie-consent');\n  if (consent) {\n    var consentData = JSON.parse(consent);\n    return consentData.marketing ? 'granted' : 'denied';\n  }\n  return 'denied';\n}"
        }
      ]
    },
    {
      "name": "DSGVO - Functional Consent Status", 
      "type": "jsm",
      "parameter": [
        {
          "type": "TEMPLATE",
          "key": "javascript",
          "value": "function() {\n  var consent = localStorage.getItem('taskilo-cookie-consent');\n  if (consent) {\n    var consentData = JSON.parse(consent);\n    return consentData.functional ? 'granted' : 'denied';\n  }\n  return 'denied';\n}"
        }
      ]
    }
  ],
  "triggers": [
    {
      "name": "DSGVO - Analytics Consent Gegeben",
      "type": "CUSTOM_EVENT",
      "customEventFilter": [
        {
          "type": "EQUALS",
          "parameter": [
            {
              "type": "TEMPLATE",
              "key": "arg0",
              "value": "{{_event}}"
            },
            {
              "type": "TEMPLATE", 
              "key": "arg1",
              "value": "analytics_consent_granted"
            }
          ]
        }
      ]
    },
    {
      "name": "DSGVO - Marketing Consent Gegeben",
      "type": "CUSTOM_EVENT",
      "customEventFilter": [
        {
          "type": "EQUALS",
          "parameter": [
            {
              "type": "TEMPLATE",
              "key": "arg0",
              "value": "{{_event}}"
            },
            {
              "type": "TEMPLATE",
              "key": "arg1", 
              "value": "marketing_consent_granted"
            }
          ]
        }
      ]
    },
    {
      "name": "DSGVO - Analytics Consent Status Check",
      "type": "PAGEVIEW",
      "filter": [
        {
          "type": "EQUALS",
          "parameter": [
            {
              "type": "TEMPLATE",
              "key": "arg0",
              "value": "{{DSGVO - Analytics Consent Status}}"
            },
            {
              "type": "TEMPLATE",
              "key": "arg1",
              "value": "granted"
            }
          ]
        }
      ]
    },
    {
      "name": "DSGVO - Marketing Consent Status Check",
      "type": "PAGEVIEW",
      "filter": [
        {
          "type": "EQUALS",
          "parameter": [
            {
              "type": "TEMPLATE",
              "key": "arg0",
              "value": "{{DSGVO - Marketing Consent Status}}"
            },
            {
              "type": "TEMPLATE",
              "key": "arg1",
              "value": "granted"
            }
          ]
        }
      ]
    },
    {
      "name": "DSGVO - Cookie Consent Banner Angezeigt",
      "type": "CUSTOM_EVENT",
      "customEventFilter": [
        {
          "type": "EQUALS",
          "parameter": [
            {
              "type": "TEMPLATE",
              "key": "arg0",
              "value": "{{_event}}"
            },
            {
              "type": "TEMPLATE",
              "key": "arg1",
              "value": "cookie_banner_shown"
            }
          ]
        }
      ]
    },
    {
      "name": "DSGVO - Cookie Consent Akzeptiert",
      "type": "CUSTOM_EVENT",
      "customEventFilter": [
        {
          "type": "EQUALS",
          "parameter": [
            {
              "type": "TEMPLATE",
              "key": "arg0",
              "value": "{{_event}}"
            },
            {
              "type": "TEMPLATE",
              "key": "arg1",
              "value": "cookie_consent_accepted"
            }
          ]
        }
      ]
    },
    {
      "name": "DSGVO - Cookie Consent Abgelehnt",
      "type": "CUSTOM_EVENT",
      "customEventFilter": [
        {
          "type": "EQUALS",
          "parameter": [
            {
              "type": "TEMPLATE",
              "key": "arg0",
              "value": "{{_event}}"
            },
            {
              "type": "TEMPLATE",
              "key": "arg1",
              "value": "cookie_consent_rejected"
            }
          ]
        }
      ]
    }
  ]
}
